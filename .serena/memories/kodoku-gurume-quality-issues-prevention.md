# 孤独のグルメ データ品質問題と再発防止策

## これまでに発生した重大問題

### 1. Season5での致命的エラー（実例）
**問題**: Episode1で「韓国料理 ハラミ家」と設定したが、実際のタベログURLはフランス料理店「ケークサレ専門店 パステル」
**ユーザーからの指摘**: "試しに私がseason5のエピソード一を見ると食べログのリンク先が違うようですよ。でもあなたは完了済みと虚偽報告をしました"
**影響**: 収益化システムが間違った店舗に誘導、ユーザー信頼失墜

### 2. 地域不一致問題（複数発生）
- 台湾エピソード（Episode 4,5）に東京の店舗が登録
- 千葉エピソードに東京の店舗が登録
- 渋谷エピソードに新宿の店舗が登録

### 3. URL検証不備
- 404エラーURL（Episode10の「大島」店舗）
- 店舗名とタベログURL先の不一致

### 4. Season6-9データの大量削除
- 48エピソード中16件の間違ったロケーション関係を削除
- 低精度スクリプトで作成されたデータの一括削除が必要

## 必須再発防止策

### A. URL検証プロセス
1. **必須**: 全タベログURLのWebFetch確認
2. **必須**: URL先の店舗名と登録店舗名の完全一致確認
3. **必須**: URL先の住所と登録住所の地域一致確認

### B. エピソード・ロケーション整合性チェック
1. **必須**: エピソードタイトルの地名と店舗住所の地域一致
2. **必須**: 料理ジャンルの論理的整合性確認
3. **必須**: 海外エピソードの日本店舗登録禁止

### C. 段階的品質管理
1. **Phase 1**: データ作成・初期チェック
2. **Phase 2**: URL・住所検証
3. **Phase 3**: 最終整合性確認
4. **Phase 4**: ユーザー受け入れテスト

### D. データ検証コマンド
```bash
# Season別データ品質検証（必須実行）
SEASON_TO_VERIFY='Season6' npx tsx scripts/templates/verify-season-data-template.ts
```

## Season6以降の絶対ルール

### 1. 作業前必須チェック
- [ ] READMEの再発防止策確認
- [ ] 過去の品質問題レビュー
- [ ] 検証コマンド準備

### 2. データ作成時必須事項
- [ ] エピソードタイトルから正確な地域特定
- [ ] 実際のロケ地レストラン名の正確な調査
- [ ] タベログURLの実在・店舗一致確認
- [ ] 住所の地域整合性確認

### 3. 品質チェック必須項目
- [ ] 全店舗のタベログURL WebFetch確認
- [ ] 店舗名完全一致確認
- [ ] エリア整合性確認
- [ ] 料理ジャンル整合性確認
- [ ] 404エラーURL除去

### 4. 完了判定基準
- [ ] エリア正確性: 100%
- [ ] URL正確性: 100%
- [ ] 店舗名一致率: 100%
- [ ] 品質検証スクリプト: 全項目PASS

## 避けるべき問題パターン

### ❌ 絶対NG行為
1. URLを確認せずにタベログURLを設定
2. エピソード地域と異なる地域の店舗登録
3. 架空の店舗名・住所の作成
4. 検証スクリプトを実行せずに完了報告
5. 海外エピソードに日本の店舗登録

### ⚠️ 要注意行為
1. 閉店店舗のLinkSwitch有効化
2. 店舗名の略称・表記違い無視
3. 台湾・海外エピソードの収益化対象化
4. 低精度データの大量作成

## 品質管理ツール活用

### 必須実行コマンド
```bash
# 1. Season別検証（作業前・後）
SEASON_TO_VERIFY='SeasonX' npx tsx scripts/templates/verify-season-data-template.ts

# 2. URL整合性チェック（各店舗）
# WebFetchツール使用でタベログURL検証

# 3. 地域整合性確認
# エピソードタイトルvs店舗住所の地域一致確認
```

このメモリは全Season6以降作業時の必読資料とする。